municipality == "MAZAPA DE MADERO" ~ 7053,
municipality == "MAZAT\xc1N" ~ 7054,
municipality == "METAPA DE DOM\xcdNGUEZ" ~ 7055,
municipality == "MITONTIC" ~ 7056,
municipality == "N CRISTOBAL DE LAS CAS" ~ 7078,
municipality == "NICOL\xc1S RUIZ" ~ 7058,
municipality == "OCOSINGO" ~ 7059,
municipality == "OCOTEPEC" ~ 7060,
municipality == "OCOZOCOAUTLA" ~ 7061,
municipality == "OSTUAC\xc1N" ~ 7062,
municipality == "OSUMACINTA" ~ 7063,
municipality == "OXCHUC" ~ 7064,
municipality == "PALENQUE" ~ 7065,
municipality == "PANTELH\xd3" ~ 7066,
municipality == "PANTEPEC" ~ 7067,
municipality == "PICHUCALCO" ~ 7068,
municipality == "PORVENIR, EL" ~ 7070,
municipality == "RAY\xd3N" ~ 7073,
municipality == "REFORMA" ~ 7074,
municipality == "ROSAS, LAS" ~ 7075,
municipality == "SABANILLA" ~ 7076,
municipality == "Salto de Agua" ~ 7077,
municipality == "SAN FERNANDO" ~ 7079,
municipality == "SAN JUAN CANCUC" ~ 7112,
municipality == "SAN LUCAS" ~ 7110,
municipality == "SIMOJOVEL" ~ 7081,
municipality == "SITAL\xc1" ~ 7082,
municipality == "SOCOLTENANGO" ~ 7083,
municipality == "SOLOSUCHIAPA" ~ 7084,
municipality == "SOYAL\xd3" ~ 7085,
municipality == "SUCHIAPA" ~ 7086,
municipality == "SUCHIATE" ~ 7087,
municipality == "SUNUAPA" ~ 7088,
municipality == "TAPACHULA" ~ 7089,
municipality == "TAPALAPA" ~ 7090,
municipality == "TAPILULA" ~ 7091,
municipality == "TECPAT\xc1N" ~ 7092,
municipality == "TENEJAPA" ~ 7093,
municipality == "TEOPISCA" ~ 7094,
municipality == "TILA" ~ 7096,
municipality == "TONALA" ~ 7097,
municipality == "TOTOLAPA" ~ 7098,
municipality == "TRINITARIA, LA" ~ 7099,
municipality == "TUMBALA" ~ 7100,
municipality == "TUXTLA CHICO" ~ 7102,
municipality == "TUXTLA GUTI\xc9RREZ" ~ 7101,
municipality == "TUZANT\xc1N" ~ 7103,
municipality == "TZIMOL" ~ 7104,
municipality == "UNI\xd3N JU\xc1REZ" ~ 7105,
municipality == "VILLA CORZO" ~ 7107,
municipality == "VILLAFLORES" ~ 7108,
municipality == "YAJAL\xd3N" ~ 7109,
municipality == "ZINACANT\xc1N" ~ 7111,
municipality == "BENEM\xc9RITO DE LAS AM\xc9RICAS" ~ 7114,
municipality == "CHAMULA" ~ 7023,
municipality == "EL BOSQUE" ~ 7014,
municipality == "EL PORVENIR" ~ 7070,
municipality == "ESCUINTLA" ~ 7032,
municipality == "LA CONCORDIA" ~ 7020,
municipality == "LA GRANDEZA" ~ 7036,
municipality == "LA INDEPENDENCIA" ~ 7041,
municipality == "LA LIBERTAD" ~ 7050,
municipality == "LA TRINITARIA" ~ 7099,
municipality == "LAS MARGARITAS" ~ 7052,
municipality == "LAS ROSAS" ~ 7075,
municipality == "MAPASTEPEC" ~ 7051,
municipality == "MARAVILLA TENEJAPA" ~ 7115,
municipality == "MARQU\xc9S DE COMILLAS" ~ 7116,
municipality == "MONTECRISTO DE GUERRERO" ~ 7117,
municipality == "MOTOZINTLA" ~ 7057,
municipality == "PIJIJIAPAN" ~ 7069,
municipality == "PUEBLO NVO. SOLISTAHUAC\xc1N" ~ 7072,
municipality == "SALTO DE AGUA" ~ 7077,
municipality == "SAN ANDR\xc9S DURAZNAL" ~ 7118,
municipality == "SAN CRIST\xd3BAL DE LAS CASAS" ~ 7078,
municipality == "SANTIAGO EL PINAR" ~ 7119,
municipality == "SILTEPEC" ~ 7080,
municipality == "TONAL\xc1" ~ 7097,
municipality == "TUMBAL\xc1" ~ 7100,
municipality == "VENUSTIANO CARRANZA" ~ 7106,
municipality == "VILLA COMALTITL\xc1N" ~ 7071,
municipality == "ANGEL ALBINO CORZO" ~ 7008,
municipality == "BELLA VISTA" ~ 7011,
municipality == "BENEMERITO DE LAS AMERICAS" ~ 7114,
municipality == "BERRIOZABAL" ~ 7012,
municipality == "CACAHOATAN" ~ 7015,
municipality == "CATAZAJA" ~ 7016,
municipality == "CHALCHIHUITAN" ~ 7022,
municipality == "CHENALHO" ~ 7026,
municipality == "CHICOASEN" ~ 7029,
municipality == "CHILON" ~ 7031,
municipality == "COMITAN DE DOMINGUEZ" ~ 7019,
municipality == "COPAINALA" ~ 7021,
municipality == "FRANCISCO LEON" ~ 7033,
municipality == "HUEHUETAN" ~ 7037,
municipality == "HUITIUPAN" ~ 7039,
municipality == "HUIXTAN" ~ 7038,
municipality == "IXHUATAN" ~ 7042,
municipality == "IXTACOMITAN" ~ 7043,
municipality == "JUAREZ" ~ 7048,
municipality == "LARRAINZAR" ~ 7049,
municipality == "MARQUES DE COMILLAS" ~ 7116,
municipality == "MAZATAN" ~ 7054,
municipality == "METAPA DE DOMINGUEZ" ~ 7055,
municipality == "NICOLAS RUIZ" ~ 7058,
municipality == "OCOZOCOAUTLA DE ESPINOSA" ~ 7061,
municipality == "OSTUACAN" ~ 7062,
municipality == "PANTELHO" ~ 7066,
municipality == "PUEBLO NVO SOLISTAHUACAN" ~ 7072,
municipality == "RAYON" ~ 7073,
municipality == "SAN ANDRES DURAZNAL" ~ 7118,
municipality == "SAN CRISTOBAL DE LAS CASAS" ~ 7078,
municipality == "SITALA" ~ 7082,
municipality == "SOYALO" ~ 7085,
municipality == "TAPILULA" | municipality == "TAPILULA EXTRAORDINARIO"~ 7091,
municipality == "TECPATAN" ~ 7092,
municipality == "TUXTLA GUTIERREZ" ~ 7101,
municipality == "TUZANTAN" ~ 7103,
municipality == "UNION JUAREZ" ~ 7105,
municipality == "VILLACOMALTITLAN" ~ 7071,
municipality == "YAJALON" ~ 7109,
municipality == "ZINACANTAN" ~ 7111,
municipality == "AMILIANO ZAPATA" | municipality == "EMILIANO ZAPATA"~ 7121,
municipality == "MEZCALAPA" ~ 7123,
municipality == "PUEBLO NUEVO SOLISTAHUACAN" ~ 7072,
municipality == "VILLA COMALTITLAN" ~ 7071,
municipality == "EL PARRAL" ~ 7122,
TRUE ~ NA_real_  # Default case for municipalities that are not in the list
))
# Generate the coalition variable for TUXTLA GUTIÉRREZ
data_2015 <- data_2015 %>%
dplyr::mutate(PRI_PVEM_PANAL_PCU = ifelse(municipality == "TUXTLA GUTIERREZ",
rowSums(across(c(PRI , PVEM , PCU , `NA`)), na.rm = TRUE),NA),
PCU = ifelse(municipality == "TUXTLA GUTIERREZ", 0, PCU),
PRI = ifelse(municipality == "TUXTLA GUTIERREZ", 0, PRI),
PVEM = ifelse(municipality == "TUXTLA GUTIERREZ", 0, PVEM),
`NA` = ifelse(municipality == "TUXTLA GUTIERREZ", 0, `NA`))
# Generate PRI_PVEM_PANAL for TAPACHULA
data_2015 <- data_2015 %>%
dplyr::mutate(PRI_PVEM_PANAL = ifelse(municipality == "TAPACHULA",
rowSums(across(c(PRI , PVEM , `NA`)), na.rm = TRUE),NA),
PRI = if_else(municipality == "TAPACHULA", 0, PRI),
PVEM = if_else(municipality == "TAPACHULA", 0, PVEM),
`NA` = if_else(municipality == "TAPACHULA", 0, `NA`))
# Generate PVEM_PANAL for municipalities that are not TAPACHULA or TUXTLA GUTIÉRREZ
data_2015 <- data_2015 %>%
dplyr::mutate(PVEM_PANAL = ifelse(municipality != "TAPACHULA" & municipality != "TUXTLA GUTIÉRREZ",
rowSums(across(c(PVEM , `NA`)), na.rm = TRUE),NA),
PVEM = ifelse(municipality != "TAPACHULA" & municipality != "TUXTLA GUTIÉRREZ" , 0, PVEM),
`NA` = ifelse(municipality != "TAPACHULA" & municipality != "TUXTLA GUTIÉRREZ", 0, `NA`))
names(data_2015)
# Generate PT_MC for municipalities
table(data_2015$`PT MC`)
data_2015 <- data_2015 %>%
dplyr::mutate(PT_MC = ifelse(`PT MC` == TRUE, rowSums(across(c(PT , MC)), na.rm = TRUE),NA))
# Set PT and MC to missing if PTMC is not missing
data_2015 <- data_2015 %>%
dplyr::mutate(PT = ifelse(!is.na(PT_MC), NA, PT),
MC = ifelse(!is.na(PT_MC), NA, MC))
# Rename NA and MOR to PANAL and MORENA
data_2015 <- data_2015 %>%
dplyr::rename(PANAL = `NA`,
MORENA = MOR)
names(data_2015)
# Collapse the data by municipality and section, summing the variables
collapsed_2015 <- data_2015 %>%
dplyr::rename(nulos = "VOTOS NULOS") %>%
dplyr::group_by(uniqueid, section) %>%
dplyr::summarise(across(c(PAN:"C I",nulos,total,PRI_PVEM_PANAL_PCU,PRI_PVEM_PANAL,PVEM_PANAL,PT_MC,valid), sum)) %>%
dplyr::mutate(year = 2015, month = "October") %>%
dplyr::rename(CI_1 = "C I")
# Load and merge Lista Nominal data
ln_data_2015 <- read_dta("../../../Data/Raw Electoral Data/Listas Nominales/LN 2012-2019/2015/LN2015.dta")
ln_data_2015 <- ln_data_2015 %>%
dplyr::filter(entidad == 7 & month == 6) %>%
dplyr::mutate(uniqueid = (entidad * 1000) , municipio) %>%
dplyr::select(seccion, lista) %>%
dplyr::rename(section = seccion)
collapsed_2015 <- collapsed_2015 %>%
dplyr::left_join(ln_data_2015, by = c("section")) %>%
dplyr::rename(listanominal = lista)
# Calculate turnout
collapsed_2015 <- collapsed_2015 %>%
dplyr::mutate(turnout = total / listanominal)
summary(collapsed_2015)
rm(data_2015)
rm(ln_data_2015)
# ---------------------- 2018 Data Processing ---------------------- #
# Import the 2018 election data
data_2018 <- read_excel("../../../Data/Raw Electoral Data/Chiapas - 1995, 1998, 2001, 2004, 2007, 2010, 2012,2015,2018/Resultados de Computos Municipales por Casilla de la Eleccion de Ayuntamientos - Chiapas 2018.xlsx")
names(data_2018)
# Rename municipality column
data_2018 <- data_2018 %>%
dplyr::rename(municipality = MUNICIPIO_LOCAL,
section = "SECCION")
# Convert municipality names to proper case
data_2018 <- data_2018 %>%
mutate(municipality = tools::toTitleCase(municipality))
# Drop elections for OXCHUC (special case)
data_2018 <- data_2018 %>%
dplyr::filter(municipality != "OXCHUC") %>%
dplyr::mutate(across(c(PAN:"TOTAL VOTOS"), as.numeric))
# Drop and generate uniqueid column
data_2018$uniqueid <- NA
# Replace special characters in the municipality column
data_2018 <- data_2018 %>%
dplyr::mutate(municipality = gsub("Á", "A", municipality),
municipality = gsub("É", "E", municipality),
municipality = gsub("Í", "I", municipality),
municipality = gsub("Ó", "O", municipality),
municipality = gsub("Ú", "U", municipality),
municipality = gsub("Ü", "U", municipality),
municipality = gsub("Ñ", "N", municipality),
municipality = tools::toTitleCase(municipality))
summary(data_2018)
# Manually assign unique IDs based on municipality names
data_2018 <- data_2018 %>%
dplyr::mutate(
uniqueid = case_when(
municipality == "ACALA" ~ 7002,
municipality == "ALDAMA" ~ 7113,
municipality == "AMATENANGO DE LA FRONTERA" ~ 7006,
municipality == "AMAT\xc1N" ~ 7005,
municipality == "ACACOYAGUA" ~ 7001,
municipality == "ACAPETAHUA" ~ 7003,
municipality == "ALTAMIRANO" ~ 7004,
municipality == "AMATAN" ~ 7005,
municipality == "AMATENANGO DE LA FRA." ~ 7006,
municipality == "AMATENANGO DEL VALLE" ~ 7007,
municipality == "\xc1NGEL ALBINO CORZO" ~ 7008,
municipality == "ARRIAGA" ~ 7009,
municipality == "BEJUCAL DE OCAMPO" ~ 7010,
municipality == "BELLAVISTA" ~ 7011,
municipality == "BERRIOZ\xc1BAL" ~ 7012,
municipality == "BOCHIL" ~ 7013,
municipality == "BOSQUE, EL" ~ 7014,
municipality == "CACAHOAT\xc1N" ~ 7015,
municipality == "CATAZAJ\xc1" ~ 7016,
municipality == "CHALCHIHUIT\xc1N" ~ 7022,
municipality == "CHANAL" ~ 7024,
municipality == "CHAPULTENANGO" ~ 7025,
municipality == "CHENALH\xd3" ~ 7026,
municipality == "CHIAPA DE CORZO" ~ 7027,
municipality == "CHIAPILLA" ~ 7028,
municipality == "CHICOAS\xc9N" ~ 7029,
municipality == "CHICOMUSELO" ~ 7030,
municipality == "CHIL\xd3N" ~ 7031,
municipality == "CINTALAPA" ~ 7017,
municipality == "COAPILLA" ~ 7018,
municipality == "COMIT\xc1N" ~ 7019,
municipality == "CONCORDIA, LA" ~ 7020,
municipality == "COPAINAL\xc1" ~ 7021,
municipality == "FRANCISCO LE\xd3N" ~ 7033,
municipality == "FRONTERA COMALAPA" ~ 7034,
municipality == "FRONTERA HIDALGO" ~ 7035,
municipality == "GRANDEZA, LA" ~ 7036,
municipality == "HUEHUET\xc1N" ~ 7037,
municipality == "HUITIUP\xc1N" ~ 7039,
municipality == "HUIXTLA" ~ 7040,
municipality == "HUIXT\xc1N" ~ 7038,
municipality == "INDEPENDENCIA, LA" ~ 7041,
municipality == "IXHUAT\xc1N" ~ 7042,
municipality == "IXTACOMIT\xc1N" ~ 7043,
municipality == "IXTAPA" ~ 7044,
municipality == "IXTAPANGAJOYA" ~ 7045,
municipality == "JIQUIPILAS" ~ 7046,
municipality == "JITOTOL" ~ 7047,
municipality == "JU\xc1REZ" ~ 7048,
municipality == "LARRA\xcdNZAR" ~ 7049,
municipality == "LIBERTAD, LA" ~ 7050,
municipality == "MARGARITAS, LAS" ~ 7052,
municipality == "MAZAPA DE MADERO" ~ 7053,
municipality == "MAZAT\xc1N" ~ 7054,
municipality == "METAPA DE DOM\xcdNGUEZ" ~ 7055,
municipality == "MITONTIC" ~ 7056,
municipality == "N CRISTOBAL DE LAS CAS" ~ 7078,
municipality == "NICOL\xc1S RUIZ" ~ 7058,
municipality == "OCOSINGO" ~ 7059,
municipality == "OCOTEPEC" ~ 7060,
municipality == "OCOZOCOAUTLA" ~ 7061,
municipality == "OSTUAC\xc1N" ~ 7062,
municipality == "OSUMACINTA" ~ 7063,
municipality == "OXCHUC" ~ 7064,
municipality == "PALENQUE" ~ 7065,
municipality == "PANTELH\xd3" ~ 7066,
municipality == "PANTEPEC" ~ 7067,
municipality == "PICHUCALCO" ~ 7068,
municipality == "PORVENIR, EL" ~ 7070,
municipality == "RAY\xd3N" ~ 7073,
municipality == "REFORMA" ~ 7074,
municipality == "ROSAS, LAS" ~ 7075,
municipality == "SABANILLA" ~ 7076,
municipality == "Salto de Agua" ~ 7077,
municipality == "SAN FERNANDO" ~ 7079,
municipality == "SAN JUAN CANCUC" ~ 7112,
municipality == "SAN LUCAS" ~ 7110,
municipality == "SIMOJOVEL" ~ 7081,
municipality == "SITAL\xc1" ~ 7082,
municipality == "SOCOLTENANGO" ~ 7083,
municipality == "SOLOSUCHIAPA" ~ 7084,
municipality == "SOYAL\xd3" ~ 7085,
municipality == "SUCHIAPA" ~ 7086,
municipality == "SUCHIATE" ~ 7087,
municipality == "SUNUAPA" ~ 7088,
municipality == "TAPACHULA" ~ 7089,
municipality == "TAPALAPA" ~ 7090,
municipality == "TAPILULA" ~ 7091,
municipality == "TECPAT\xc1N" ~ 7092,
municipality == "TENEJAPA" ~ 7093,
municipality == "TEOPISCA" ~ 7094,
municipality == "TILA" ~ 7096,
municipality == "TONALA" ~ 7097,
municipality == "TOTOLAPA" ~ 7098,
municipality == "TRINITARIA, LA" ~ 7099,
municipality == "TUMBALA" ~ 7100,
municipality == "TUXTLA CHICO" ~ 7102,
municipality == "TUXTLA GUTI\xc9RREZ" ~ 7101,
municipality == "TUZANT\xc1N" ~ 7103,
municipality == "TZIMOL" ~ 7104,
municipality == "UNI\xd3N JU\xc1REZ" ~ 7105,
municipality == "VILLA CORZO" ~ 7107,
municipality == "VILLAFLORES" ~ 7108,
municipality == "YAJAL\xd3N" ~ 7109,
municipality == "ZINACANT\xc1N" ~ 7111,
municipality == "BENEM\xc9RITO DE LAS AM\xc9RICAS" ~ 7114,
municipality == "CHAMULA" ~ 7023,
municipality == "EL BOSQUE" ~ 7014,
municipality == "EL PORVENIR" ~ 7070,
municipality == "ESCUINTLA" ~ 7032,
municipality == "LA CONCORDIA" ~ 7020,
municipality == "LA GRANDEZA" ~ 7036,
municipality == "LA INDEPENDENCIA" ~ 7041,
municipality == "LA LIBERTAD" ~ 7050,
municipality == "LA TRINITARIA" ~ 7099,
municipality == "LAS MARGARITAS" ~ 7052,
municipality == "LAS ROSAS" ~ 7075,
municipality == "MAPASTEPEC" ~ 7051,
municipality == "MARAVILLA TENEJAPA" ~ 7115,
municipality == "MARQU\xc9S DE COMILLAS" ~ 7116,
municipality == "MONTECRISTO DE GUERRERO" ~ 7117,
municipality == "MOTOZINTLA" ~ 7057,
municipality == "PIJIJIAPAN" ~ 7069,
municipality == "PUEBLO NVO. SOLISTAHUAC\xc1N" ~ 7072,
municipality == "SALTO DE AGUA" ~ 7077,
municipality == "SAN ANDR\xc9S DURAZNAL" ~ 7118,
municipality == "SAN CRIST\xd3BAL DE LAS CASAS" ~ 7078,
municipality == "SANTIAGO EL PINAR" ~ 7119,
municipality == "SILTEPEC" ~ 7080,
municipality == "TONAL\xc1" ~ 7097,
municipality == "TUMBAL\xc1" ~ 7100,
municipality == "VENUSTIANO CARRANZA" ~ 7106,
municipality == "VILLA COMALTITL\xc1N" ~ 7071,
municipality == "ANGEL ALBINO CORZO" ~ 7008,
municipality == "BELLA VISTA" ~ 7011,
municipality == "BENEMERITO DE LAS AMERICAS" ~ 7114,
municipality == "BERRIOZABAL" ~ 7012,
municipality == "CACAHOATAN" ~ 7015,
municipality == "CATAZAJA" ~ 7016,
municipality == "CHALCHIHUITAN" ~ 7022,
municipality == "CHENALHO" ~ 7026,
municipality == "CHICOASEN" ~ 7029,
municipality == "CHILON" ~ 7031,
municipality == "COMITAN DE DOMINGUEZ" ~ 7019,
municipality == "COPAINALA" ~ 7021,
municipality == "FRANCISCO LEON" ~ 7033,
municipality == "HUEHUETAN" ~ 7037,
municipality == "HUITIUPAN" ~ 7039,
municipality == "HUIXTAN" ~ 7038,
municipality == "IXHUATAN" ~ 7042,
municipality == "IXTACOMITAN" ~ 7043,
municipality == "JUAREZ" ~ 7048,
municipality == "LARRAINZAR" ~ 7049,
municipality == "MARQUES DE COMILLAS" ~ 7116,
municipality == "MAZATAN" ~ 7054,
municipality == "METAPA DE DOMINGUEZ" ~ 7055,
municipality == "NICOLAS RUIZ" ~ 7058,
municipality == "OCOZOCOAUTLA DE ESPINOSA" ~ 7061,
municipality == "OSTUACAN" ~ 7062,
municipality == "PANTELHO" ~ 7066,
municipality == "PUEBLO NVO SOLISTAHUACAN" ~ 7072,
municipality == "RAYON" ~ 7073,
municipality == "SAN ANDRES DURAZNAL" ~ 7118,
municipality == "SAN CRISTOBAL DE LAS CASAS" ~ 7078,
municipality == "SITALA" ~ 7082,
municipality == "SOYALO" ~ 7085,
municipality == "TAPILULA" | municipality == "TAPILULA EXTRAORDINARIO"~ 7091,
municipality == "TECPATAN" ~ 7092,
municipality == "TUXTLA GUTIERREZ" ~ 7101,
municipality == "TUZANTAN" ~ 7103,
municipality == "UNION JUAREZ" ~ 7105,
municipality == "VILLACOMALTITLAN" ~ 7071,
municipality == "YAJALON" ~ 7109,
municipality == "ZINACANTAN" ~ 7111,
municipality == "AMILIANO ZAPATA" | municipality == "EMILIANO ZAPATA"~ 7121,
municipality == "MEZCALAPA" ~ 7123,
municipality == "PUEBLO NUEVO SOLISTAHUACAN" ~ 7072,
municipality == "VILLA COMALTITLAN" ~ 7071,
municipality == "EL PARRAL" ~ 7122,
municipality == "METAPA" ~ 7055,
municipality == "RINCON CHAMULA SAN PEDRO" ~ 7121,
municipality == "CAPITAN LUIS ANGEL VIDAL" ~ 7120,
TRUE ~ NA_real_  # Default case for municipalities that are not in the list
))
names(data_2018)
# Collapse the data by municipality and section, summing the variables
collapsed_2018 <- data_2018 %>%
dplyr::rename(nulos = "VOTOS NULOS",
total = "TOTAL VOTOS")
collapsed_2018 <- collapsed_2018 %>%
dplyr::rename(
CI_19 = "CAND_IND_19", CI_6 = "CAND_IND_6", CI_5 = "CAND_IND_5",
CI_4 = "CAND_IND_4", CI_3 = "CAND_IND_3", CI_2 = "CAND_IND_2",
CI_7 = "CAND_IND_7", CI_9 = "CAND_IND_9", CI_10 = "CAND_IND_10",
CI_11 = "CAND_IND_11", CI_12 = "CAND_IND_12", CI_1 = "CAND_IND_1",
CI_13 = "CAND_IND_13", CI_14 = "CAND_IND_14", CI_15 = "CAND_IND_15",
CI_16 = "CAND_IND_16", CI_17 = "CAND_IND_17", CI_18 = "CAND_IND_18",
CI_8 = "CAND_IND_8", CI_20 = "CAND_IND_20", CI_21 = "CAND_IND_21",
CI_22 = "CAND_IND_22", CI_23 = "CAND_IND_23", CI_24 = "CAND_IND_24",
CI_25 = "CAND_IND_25", CI_26 = "CAND_IND_26", CI_27 = "CAND_IND_27",
CI_28 = "CAND_IND_28", CI_29 = "CAND_IND_29", CI_30 = "CAND_IND_30",
CI_31 = "CAND_IND_31", CI_32 = "CAND_IND_32", CI_33 = "CAND_IND_33",
CI_34 = "CAND_IND_34", CI_35 = "CAND_IND_35", CI_36 = "CAND_IND_36",
CI_37 = "CAND_IND_37", CI_38 = "CAND_IND_38", CI_39 = "CAND_IND_39",
CI_40 = "CAND_IND_40", CI_41 = "CAND_IND_41")
names(collapsed_2018)
# Create the PAN_PRD_MC variable
collapsed_2018 <- collapsed_2018 %>%
dplyr::mutate(PAN_PRD_MC = rowSums(across(c(PAN,PRD,PMC,"PAN PRD","PAN PMC","PRD PMC",
"PAN PRD PMC")), na.rm = TRUE),
PAN_PRD_MC = ifelse(!is.na("PAN PRD PMC"), PAN_PRD_MC, NA),
PAN = ifelse(!is.na("PAN PRD PMC"), NA, PAN),
PRD = ifelse(!is.na("PAN PRD PMC"), NA, PRD),
PMC = ifelse(!is.na("PAN PRD PMC"), NA, PMC))
# Drop unnecessary columns
collapsed_2018 <- collapsed_2018 %>%
dplyr::select(-c("PAN PRD", "PAN PMC", "PRD PMC", "PAN PRD PMC")) %>%
dplyr::rename(MC = PMC)
# Create the data_2018 variable
collapsed_2018 <- collapsed_2018 %>%
dplyr::mutate(PRI_PVEM_PANAL_PCU = rowSums(across(c(PRI , PVEM , PNA , PCHU , "PRI PVEM PNA PCHU" , "PRI PVEM PNA" ,
"PRI PVEM PCHU" , "PRI PNA PCHU" , "PVEM PNA PCHU" , "PRI PVEM" , "PRI PNA" ,
"PRI PCHU" , "PVEM PNA" , "PVEM PCHU" , "PNA PCHU")), na.rm = TRUE),
PRI_PVEM_PANAL_PCU = ifelse(!is.na("PRI PVEM PNA PCHU"), PRI_PVEM_PANAL_PCU, NA),
PRI = ifelse(!is.na("PRI PVEM PNA PCHU"), NA, PRI),
PVEM = ifelse(!is.na("PRI PVEM PNA PCHU"), NA, PVEM),
PNA = ifelse(!is.na("PRI PVEM PNA PCHU"), NA, PNA),
PCHU = ifelse(!is.na("PRI PVEM PNA PCHU"), NA, PCHU))
# Drop unnecessary columns and rename variables
collapsed_2018 <- collapsed_2018 %>%
dplyr::select(-c("PRI PVEM PNA PCHU" , "PRI PVEM PNA" ,
"PRI PVEM PCHU" , "PRI PNA PCHU" , "PVEM PNA PCHU" , "PRI PVEM" , "PRI PNA" ,
"PRI PCHU" , "PVEM PNA" , "PVEM PCHU" , "PNA PCHU")) %>%
dplyr::rename(PANAL = PNA, PCU = PCHU)
# Create PT_MORENA_PES variable
collapsed_2018 <- collapsed_2018 %>%
dplyr::mutate(PT_MORENA_PES = ifelse(uniqueid != 7030 & uniqueid != 7083,
rowSums(across(c(PT , MORENA , PES , "PT MORENA" , "PT PES" ,
"MORENA PES" , "PT MORENA PES")), na.rm = TRUE),NA))
# Set PT, MORENA, PES to NA where appropriate
collapsed_2018 <- collapsed_2018 %>%
dplyr::mutate(across(c(PT, MORENA, PES), ~ ifelse(uniqueid != 7030 & uniqueid != 7083, NA, .)))
# Drop unnecessary columns related to PT_MORENA_PES coalition
collapsed_2018 <- collapsed_2018 %>%
dplyr::select(-c("PT MORENA PES", "PT MORENA", "PT PES", "MORENA PES"))
# Rename PMCH to MVC
collapsed_2018 <- collapsed_2018 %>%
dplyr::rename(MVC = PMCH)
names(collapsed_2018)
# Collapse (group by) municipality, section, and uniqueid, summing across relevant columns
collapsed_2018 <- collapsed_2018 %>%
dplyr::group_by(municipality, section, uniqueid) %>%
dplyr::summarise(across(c(PAN:PT_MORENA_PES), sum, na.rm = TRUE))
# Create valid votes by summing specific columns
collapsed_2018 <- collapsed_2018 %>%
dplyr::mutate(valid = rowSums(across(c(PAN, PRI, PRD, PT, PVEM, MC, PANAL, PCU, MORENA, PES, MVC,
PRI_PVEM_PANAL_PCU, PAN_PRD_MC, PT_MORENA_PES,
CI_19, CI_6, CI_5, CI_4, CI_3, CI_2, CI_7, CI_9, CI_10, CI_11, CI_12, CI_1,
CI_13, CI_14, CI_15, CI_16, CI_17, CI_18, CI_8, CI_20, CI_21, CI_22, CI_23,
CI_24, CI_25, CI_26, CI_27, CI_28, CI_29, CI_30, CI_31, CI_32, CI_33,
CI_34, CI_35, CI_36, CI_37, CI_38, CI_39, CI_40, CI_41)), na.rm = TRUE))
# Load and merge Lista Nominal data
ln_data_2018 <- read_dta("../../../Data/Raw Electoral Data/Listas Nominales/LN 2012-2019/2018/LN2018.dta")
ln_data_2018 <- ln_data_2018 %>%
dplyr::filter(entidad == 7 & month == 8) %>%
dplyr::mutate(uniqueid = (entidad * 1000) , municipio) %>%
dplyr::select(seccion, lista) %>%
dplyr::rename(section = seccion)
collapsed_2018 <- collapsed_2018 %>%
dplyr::left_join(ln_data_2018, by = c("section")) %>%
dplyr::rename(listanominal = lista)
# Calculate turnout and municipal turnout
collapsed_2018 <- collapsed_2018 %>%
dplyr::mutate(turnout = total / listanominal,
year = 2018,
month = "August")
names(chiapas_all)
# Calculate turnout and municipal turnout
collapsed_2018 <- collapsed_2018 %>%
dplyr::mutate(turnout = total / listanominal,
year = 2018,
month = "August")
# Combine the dataframes, handling different columns by filling with NA
chiapas_all <- bind_rows(collapsed_1995,
collapsed_1998,
collapsed_2001,
collapsed_2004,
collapsed_2007,
collapsed_2010,
collapsed_2012,
collapsed_2015,
collapsed_2018)
data.table::fwrite(chiapas_all,"../../../Processed Data/chiapas/chiapas_process_raw_data.csv")
